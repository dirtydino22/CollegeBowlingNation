(function(){"use strict";angular.module("app",["ngRoute","ui.bootstrap","ngGrid","app.controllers","app.services","app.directives","app.filters"]).config(function($routeProvider,$locationProvider,$httpProvider){$httpProvider.interceptors.push(function($q,$location,Online){return{request:function(config){return Online.check()?config||$q.when(config):-1===config.url.indexOf("api/")?config||$q.when(config):Online.requests.push({url:config.url,method:config.method,data:config.data})},response:function(response){return response||$q.when(response)},responseError:function(rejection){return 401===rejection.status&&$location.url("/login"),$q.reject(rejection)}}}),$routeProvider.when("/",{templateUrl:"templates/main.html",controller:"MainCtrl"}).when("/rankings",{templateUrl:"templates/rankings.html",controller:"RankingsCtrl"}).when("/prospects",{templateUrl:"templates/prospects.html",controller:"ProspectsCtrl"}).when("/blog",{templateUrl:"templates/blog.html",controller:"BlogCtrl"}).when("/account",{templateUrl:"templates/account.html",controller:"AccountCtrl",resolve:{auth:function(Auth){Auth.isLoggedIn()}}}).when("/admin",{templateUrl:"templates/admin.html",controller:"AdminCtrl",resolve:{auth:function(Auth){Auth.isLoggedIn()}}}).when("/newgame",{templateUrl:"templates/bowler.html",controller:"BowlerCtrl",resolve:{auth:function(Auth){Auth.isLoggedIn()}}}).when("/newgame/:id",{templateUrl:"templates/newgame.html",controller:"NewGameCtrl",resolve:{auth:function(Auth){Auth.isLoggedIn()}}}).otherwise({redirectTo:"/"})}).run(function($http,$q,$window,Online,socket){Online.on("online",function(){if(Online.requests.length){for(var reqArray=[],handleRequest=function(req,method,obj){return obj?"post"===method?$http.post(req,obj):$http.put(req,obj):"post"===method?$http.post(req):$http.put(req)},i=0;i<Online.requests.length;i++)switch(Online.requests[i].method.toLowerCase()){case"get":reqArray.push($http.get(Online.requests[i].url));break;case"post":reqArray.push(handleRequest(Online.requests[i].url,"post",Online.requests[i].data));break;case"delete":reqArray.push($http.delete(Online.requests[i].url));break;case"put":reqArray.push(handleRequest(Online.requests[i].url,"put",Online.requests[i].data))}var uniqueArray=function(ogArr){var found,x,y,newArr=[],ogLength=ogArr.length;for(x=0;ogLength>x;x++){for(found=void 0,y=0;y<newArr.length;y++)if(ogArr[x]===newArr[y]){found=!0;break}found||newArr.push(ogArr[x])}return newArr};$q.all(uniqueArray(reqArray)).then(function(results){results&&(console.log(uniqueArray(reqArray)),console.log(results),console.log("Results were returned."),socket.emit("offline:update"),Online.requests=[])})}else console.log("No Requests.")})}),window.addEventListener("load",function(){window.applicationCache.addEventListener("updateready",function(){window.applicationCache.status===window.applicationCache.UPDATEREADY&&confirm("A new version of this site is available. Load it?")&&window.location.reload()})})}).call(this),function(){"use strict";angular.module("app.controller.account",[]).controller("AccountCtrl",["$scope","$http","Universities","Auth",function($scope,$http,Universities,Auth){$scope.user={},$scope.universities=Universities.get(),$http.get("api/users/"+Auth.user.id).success(function(user){$scope.user=user}),$scope.updateInfo=function(){$http.post("api/users/"+Auth.user.id+"/info",{firstName:$scope.user.firstName,lastName:$scope.user.lastName,address:$scope.user.address,address2:$scope.user.address2,city:$scope.user.city,state:$scope.user.state,zipcode:$scope.user.zipcode,phone:$scope.user.phone,university:$scope.user.university.name,email:$scope.user.email}).success(function(){console.log("User updated")}).error(function(err){console.log(err)})},$scope.updatePassword=function(){$scope.user.password===$scope.user.confirm&&Auth.updatePassword(Auth.user.id,$scope.user.password,function(){console.log("Password Updated.")})}}])}.call(this),function(){"use strict";angular.module("app.controller.admin",[]).controller("AdminCtrl",["$scope","$http","Auth","socket","localStorage","Online",function($scope,$http,Auth,socket,localStorage,Online){if(socket.on("tempUser:update",function(tempUsers){localStorage.set("tempUsers",angular.toJson(tempUsers)),$scope.tempUsers=tempUsers}),Online.check())$http.get("api/tempUsers").success(function(users){localStorage.set("tempUsers",angular.toJson(users)),$scope.tempUsers=users}).error(function(err){console.log(err)});else try{localStorage.get("tempUsers").then(function(users){$scope.tempUsers=angular.fromJson(users)})}catch(err){console.log("No Data")}if($scope.declineUser=function($index){var id=$scope.tempUsers[$index]._id;$http.get("api/tempUsers/"+id+"/decline").success(function(){socket.emit("tempUser:update")}).error(function(err){console.log(err)})},$scope.acceptUser=function($index){var id=$scope.tempUsers[$index]._id;$http.get("api/tempUsers/"+id+"/accept/user").success(function(){socket.emit("tempUser:update"),socket.emit("user:update")}).error(function(){console.log(err)})},$scope.acceptAdmin=function($index){var id=$scope.tempUsers[$index]._id;$http.get("api/tempUsers/"+id+"/accept/admin").success(function(){socket.emit("tempUser:update"),socket.emit("user:update")}).error(function(){console.log(err)})},socket.on("user:update",function(users){localStorage.set("users",angular.toJson(users)),$scope.users=users}),Online.check())$http.get("api/users").success(function(users){localStorage.set("users",angular.toJson(users)),$scope.users=users}).error(function(err){console.log(err)});else try{localStorage.get("users").then(function(users){$scope.users=angular.fromJson(users)})}catch(err){console.log("No Data")}if($scope.removeUser=function($index){var id=$scope.users[$index]._id;$http.post("api/users/"+id+"/remove").success(function(){socket.emit("user:update")}).error(function(err){console.log(err)})},socket.on("newBowler:update",function(bowlers){localStorage.set("bowlers",angular.toJson(bowlers)),$scope.bowlers=bowlers}),Online.check())$http.get("api/bowlers").success(function(bowlers){localStorage.set("bowlers",angular.toJson(bowlers)),$scope.bowlers=bowlers}).error(function(err){console.log(err)});else try{localStorage.get("bowlers").then(function(bowlers){$scope.bowlers=angular.fromJson(bowlers)})}catch(err){console.log("No Data")}if($scope.removeBowler=function($index){var id=$scope.bowlers[$index]._id;$http.delete("api/bowlers/"+id).success(function(){socket.emit("newBowler:update")}).error(function(err){console.log(err)})},socket.on("news:update",function(news){localStorage.set("news",angular.toJson(news)),$scope.news=news}),$scope.newNews={},$scope.news={},Online.check())$http.get("api/news").success(function(news){localStorage.set("news",angular.toJson(news)),$scope.news=news}).error(function(err){console.log(err)});else try{localStorage.get("news").then(function(news){$scope.news=angular.fromJson(news)})}catch(err){console.log("No Data")}$scope.addNews=function(){$http.post("api/news",{author:$scope.newNews.author,title:$scope.newNews.title,body:$scope.newNews.body}).success(function(){socket.emit("news:update")}).error(function(err){console.log(err)})},$scope.removeNews=function(id){$http.delete("api/news/"+id).success(function(){socket.emit("news:update")}).error(function(err){console.log(err)})}}])}.call(this),function(){"use strict";angular.module("app.controller.blog",[]).controller("BlogCtrl",["$scope","$http","$modal","socket","Auth","localStorage","Online",function($scope,$http,$modal,socket,Auth,localStorage,Online){if(socket.on("post:update",function(posts){localStorage.set("posts",angular.toJson(posts)),$scope.posts=posts}),$scope.admin="admin"===Auth.user.access?!0:!1,$scope.reply={},Online.check())$http.get("api/posts").success(function(posts){localStorage.set("posts",angular.toJson(posts)),$scope.posts=posts}).error(function(err){console.log(err)});else try{localStorage.get("posts").then(function(posts){$scope.posts=angular.fromJson(posts)})}catch(err){console.log("No Data")}$scope.openNewPostModal=function(){var modalInstance=$modal.open({templateUrl:"templates/modals/modal.post.html",controller:"PostCtrl"});modalInstance.result.then(function(){socket.emit("post:update")})},$scope.addReply=function(id){$http.post("api/posts/"+id+"/reply",$scope.reply).success(function(){socket.emit("post:update")}).error(function(err){console.log(err)})},$scope.removePost=function(id){$http.delete("api/posts/"+id).success(function(){console.log("Post removed."),socket.emit("post:update")}).error(function(err){console.log(err)})}}])}.call(this),function(angular){"use strict";angular.module("app.controller.bowler",[]).controller("BowlerCtrl",["$scope","$http","socket","Universities","localStorage","Online",function($scope,$http,socket,Universities,localStorage,Online){if($scope.newBowler={},$scope.universities=Universities.get(),socket.on("newBowler:update",function(bowlers){localStorage.set("bowlers",angular.toJson(bowlers)),$scope.bowlers=bowlers}),Online.check())$http.get("api/bowlers").success(function(bowlers){$scope.bowlers=bowlers}).error(function(err){console.log(err)});else try{localStorage.get("bowlers").then(function(bowlers){$scope.bowlers=angular.fromJson(bowlers)})}catch(err){console.log("No Data")}$scope.createBowler=function(){$http.post("api/bowlers",{name:$scope.newBowler.name,university:$scope.newBowler.university.name}).success(function(){socket.emit("newBowler:update"),$scope.newBowler=""}).error(function(err){console.log(err)})}}])}(angular),function(){"use strict";angular.module("app.controller.contact",[]).controller("ContactCtrl",["$scope","$http","$modalInstance",function($scope,$http,$modalInstance){$scope.contact={},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.sendMessage=function(){$http.post("/mail",{name:$scope.contact.fullName,email:$scope.contact.email,message:$scope.contact.message}).success(function(){$modalInstance.close()}).error(function(err){console.log(err)})}}])}.call(this),function(angular){"use strict";angular.module("app.controller.login",[]).controller("LoginCtrl",["$scope","$modalInstance","Auth","Universities",function($scope,$modalInstance,Auth,Universities){$scope.createMode=!1,$scope.user={},$scope.loginUser={},$scope.universities=Universities.get(),$scope.login=function(){Auth.login($scope.loginUser.username,$scope.loginUser.password,function(){$modalInstance.close()})},$scope.register=function(){$scope.createMode=!$scope.createMode},$scope.createAccount=function(){$scope.user.password===$scope.user.confirm&&Auth.createUser($scope.user,function(){$modalInstance.close()})}}])}(angular),function(){"use strict";angular.module("app.controller.main",[]).controller("MainCtrl",["$scope","$http","socket","localStorage","Online",function($scope,$http,socket,localStorage,Online){if(socket.on("news:update",function(news){$scope.news=news}),Online.check())$http.get("api/news").success(function(news){localStorage.set("news",angular.toJson(news)),$scope.news=news}).error(function(err){console.log(err)});else try{localStorage.get("news").then(function(news){$scope.news=angular.fromJson(news)})}catch(err){console.log("No Data")}}])}.call(this),function(angular){"use strict";angular.module("app.controller.navigation",[]).controller("NavigationCtrl",["$scope","$modal","Auth",function($scope,$modal,Auth){$scope.isCollapsed=!0,$scope.user=Auth.user.username,$scope.admin="admin"===Auth.user.access?!0:!1,$scope.openLoginModal=function(){var modalInstance=$modal.open({templateUrl:"templates/modals/modal.login.html",controller:"LoginCtrl"});modalInstance.result.then(function(){$scope.user=Auth.user.username,$scope.admin="admin"===Auth.user.access?!0:!1})},$scope.openContactModal=function(){$modal.open({templateUrl:"templates/modals/modal.contact.html",controller:"ContactCtrl"})},$scope.logout=function(){Auth.logout(function(){$scope.user=Auth.user.username,$scope.admin=Auth.user.access})}}])}(angular),function(angular){"use strict";angular.module("app.controller.newGame",[]).controller("NewGameCtrl",["$scope","$routeParams","socket",function($scope,$routeParams){$scope.id=$routeParams.id}])}(angular),function(){"use strict";angular.module("app.controller.post",[]).controller("PostCtrl",["$scope","$http","$modalInstance",function($scope,$http,$modalInstance){$scope.post={},$scope.submitPost=function(){$http.post("api/posts",{author:$scope.post.author,body:$scope.post.body,title:$scope.post.title}).success(function(){$modalInstance.close()}).error(function(err){console.log(err)})}}])}.call(this),function(){"use strict";angular.module("app.controller.prospects",[]).controller("ProspectsCtrl",["$scope","$http",function($scope,$http){var userArray=[];$scope.prospect={},$scope.genders=[{type:"Male"},{type:"Female"}],$scope.bowlStyle=[{type:"Right-handed"},{type:"Left-handed"}],$scope.admissionStatus=[{type:"I have been admitted to college."},{type:"I have applied to college."}],$scope.collegeClass=[{type:"New Freshman"},{type:"Transfer Student"},{type:"Graduate Student"}],$scope.financialAid=[{applied:"Yes"},{applied:"No"}],$http.get("api/users").success(function(users){console.log(users);var i;for(i=0;i<users.length;i++)userArray.push({desc:users[i].firstName+" "+users[i].lastName+" "+users[i].university+" : "+users[i].email,name:users[i].firstName+users[i].lastName,email:users[i].email});$scope.coaches=userArray}).error(function(err){console.log(err)}),$scope.sendToCoach=function(){$http.post("/mailtocoach",{fullName:$scope.prospect.fullName,gender:$scope.prospect.gender.type,email:$scope.prospect.email,address:$scope.prospect.address,city:$scope.prospect.city,state:$scope.prospect.state,zipcode:$scope.prospect.zipcode,country:$scope.prospect.country,highschool:$scope.prospect.highschool,classification:$scope.prospect.classification,schoolCity:$scope.prospect.schoolCity,schoolState:$scope.prospect.schoolState,gpa:$scope.prospect.gpa,act:$scope.prospect.act,major:$scope.prospect.major,admissionStatus:$scope.prospect.admissionStatus.type,collegeClass:$scope.prospect.collegeClass.type,financialAid:$scope.prospect.financialAid.applied,bowlStyle:$scope.prospect.bowlStyle.type,currentAverage:$scope.prospect.currentAverage,highAverage:$scope.prospect.highAverage,schoolOfIntrest:$scope.prospect.schoolOfIntrest,coachToContact:$scope.prospect.coachToContact.email,message:$scope.prospect.message}).success(function(){console.log("Message Sent.")}).error(function(err){console.log(err)})}}])}.call(this),function(){"use strict";angular.module("app.controller.rankings",[]).controller("RankingsCtrl",["$scope","$http","$modal","socket","localStorage","Online",function($scope,$http,$modal,socket,localStorage,Online){var getGames,createGameObject,analyzeGameData,createAnalyzedDataArray;if($scope.teamData=[],$scope.selectedTeams=[],$scope.message="",$scope.$watchCollection("selectedTeams",function(){if($scope.selectedTeams.length>0){var modalInstance=$modal.open({templateUrl:"templates/modals/modal.team.html",controller:"TeamCtrl",resolve:{team:function(){return $scope.selectedTeams}}});modalInstance.result.then(function(){$scope.message="Please deselect team before choosing another."})}0===$scope.selectedTeams.length&&($scope.message="")}),socket.on("stats:update",function(stats){localStorage.set("stats",angular.toJson(stats)),$scope.teamData=createAnalyzedDataArray([analyzeGameData(createGameObject(getGames(stats)))])}),Online.check())$http.get("api/teams").success(function(stats){localStorage.set("stats",angular.toJson(stats)),$scope.teamData=createAnalyzedDataArray([analyzeGameData(createGameObject(getGames(stats)))])}).error(function(err){console.log(err)});else try{localStorage.get("stats").then(function(stats){$scope.teamData=createAnalyzedDataArray([analyzeGameData(createGameObject(getGames(angular.fromJson(stats))))])})}catch(err){console.log("No Data")}$scope.gridOptions={data:"teamData",columnDefs:[{field:"name",displayName:"University"},{field:"strikePercentage",displayName:"Strike %"},{field:"sparePercentage",displayName:"Spare %"},{field:"gamesPlayed",displayName:"Games Played"}],selectedItems:$scope.selectedTeams},createAnalyzedDataArray=function(data){var arr=[];for(var key in data[0])arr.push(data[0][key]);return arr},getGames=function(data){var i,arr=[];for(i=0;i<data.length;i++)data[i].games.length>0&&arr.push({university:data[i].university,game:data[i].games});return arr},createGameObject=function(data){var myObj={};return Object.keys(data).forEach(function(key){if(myObj.hasOwnProperty(data[key].university)||(myObj[data[key].university]={games:[],name:data[key].university}),data[key].game.length>1)for(var i=0;i<data[key].game.length;i++)myObj[data[key].university].games.push(data[key].game[i]);else 1===data[key].game.length&&myObj[data[key].university].games.push(data[key].game[0])}),myObj},analyzeGameData=function(gameObj){var scoreObj={};for(var key in gameObj){var model=(gameObj[key],{pinCount:0,rollCount:0,gutterBalls:0,strikes:0,spares:0,strikePercentage:0,sparePercentage:0,name:void 0,gamesPlayed:0});if(gameObj[key].games.length>1){for(var i=0;i<gameObj[key].games.length;i++)model.pinCount+=gameObj[key].games[i].pinCount,model.rollCount+=gameObj[key].games[i].rollCount,model.gutterBalls+=gameObj[key].games[i].gutterBalls,model.strikes+=gameObj[key].games[i].strikes,model.spares+=gameObj[key].games[i].spares,model.strikePercentage+=gameObj[key].games[i].strikePercentage,model.sparePercentage+=gameObj[key].games[i].sparePercentage,model.name=gameObj[key].name,model.gamesPlayed=gameObj[key].games.length;model.strikePercentage=Math.round(model.strikePercentage/model.gamesPlayed)/100,model.sparePercentage=Math.round(model.sparePercentage/model.gamesPlayed)/100,scoreObj[key]=model}else model.pinCount+=gameObj[key].games[0].pinCount,model.rollCount+=gameObj[key].games[0].rollCount,model.gutterBalls+=gameObj[key].games[0].gutterBalls,model.strikes+=gameObj[key].games[0].strikes,model.spares+=gameObj[key].games[0].spares,model.strikePercentage+=Math.round(gameObj[key].games[0].strikePercentage)/100,model.sparePercentage+=Math.round(gameObj[key].games[0].sparePercentage)/100,model.name=gameObj[key].name,model.gamesPlayed=1,scoreObj[key]=model}return scoreObj}}])}.call(this),function(){"use strict";angular.module("app.controller.team",[]).controller("TeamCtrl",["$scope","$modalInstance","$http","team",function($scope,$modalInstance,$http,team){var pinCount=[],strikes=[],spares=[],gutters=[],rolls=[],sum=function(data){var i,sum=0,length=data.length;for(i=0;length>i;i++)sum+=data[i];return sum};$scope.team=team[0],$scope.teamData=void 0,$scope.games=void 0,$scope.stats=[0,0,0],$http.get("api/teams/"+$scope.team.name).success(function(data){$scope.teamData=data[0],$scope.games=data[0].games,console.log(data[0].games);for(var i in data[0].games)pinCount.push(data[0].games[i].pinCount),strikes.push(data[0].games[i].strikes),spares.push(data[0].games[i].spares),gutters.push(data[0].games[i].gutterBalls),rolls.push(data[0].games[i].rollCount);$scope.stats=[sum(pinCount),sum(strikes),sum(spares),sum(gutters),sum(rolls)]}),$scope.ok=function(){$modalInstance.close()}}])}.call(this),function(angular){"use strict";angular.module("app.controllers",["app.controller.navigation","app.controller.main","app.controller.login","app.controller.contact","app.controller.rankings","app.controller.prospects","app.controller.admin","app.controller.newGame","app.controller.bowler","app.controller.team","app.controller.account","app.controller.blog","app.controller.post"])}(angular),function(){angular.module("app.directive.bars",[]).directive("bars",[function(){return{restrict:"A",replace:!0,scope:{data:"="},template:'<div id="chart"></div>',link:function($scope,$element){var labels=["Pin Count","Strikes","Spares","Gutter-Balls","Rolls"],chart=d3.select($element[0]).append("div").attr("class","chart").selectAll("div").data($scope.data).enter().append("div").transition().ease("elastic").style("width",function(d){return d+"%"}).attr("text-anchor","middle").text(function(d){return d+"%"});$scope.$watch("data",function(newVal,oldVal){return newVal?(chart=d3.select($element[0]).selectAll("*").remove(),chart=d3.select($element[0]).append("div").attr("class","chart").selectAll("div").data(newVal).enter().append("div").transition().ease("elastic").style("width",function(d){return 15>d?d+5+"%":d>100?.1*d+"%":d>1e3?.01*d+"%":d>1e5?.001*d+"%":d+"%"}).attr("text-anchor","middle").text(function(d,index){return labels[index]+" "+d})):oldVal})}}}])}.call(this),function(){angular.module("app.directive.replies",[]).directive("replies",["$http","socket",function($http,socket){return{restrict:"A",replace:!0,scope:{replies:"=",id:"="},templateUrl:"templates/replies.html",link:function($scope){$scope.replies.reverse(),$scope.reply={},$scope.addReply=function(){$http.post("api/posts/"+$scope.id+"/reply",$scope.reply).success(function(){socket.emit("post:update")}).error(function(err){console.log(err)})}}}}])}.call(this),function(){"use strict";angular.module("app.directive.scoreCard",[]).directive("scoreCard",["$http","socket",function($http,socket){return{restrict:"EA",scope:{id:"@"},templateUrl:"templates/scorecard.html",link:function($scope){var isGameOver,isSecondRoll,isTenthFrame,isTenthFrameThirdRollSpareTry,isTooLargeForSpare,analyze;$scope.pinsArray=[0,1,2,3,4,5,6,7,8,9,10],$scope.frames=[1,2,3,4,5,6,7,8,9],$scope.rolls=[],$scope.rollCount=0,$scope.frameScores=[],$scope.rollDisplay="",$scope.stats={},$scope.gameOver=!1,$scope.addRoll=function(pins){$scope.rolls.push(pins),$scope.rollCount++,$scope.frameScores=$scope.$eval("rolls | frameScores"),$scope.rollDisplay=$scope.$eval("rolls | rollDisplay"),isGameOver()&&($scope.gameOver=!0,analyze())},$scope.reset=function(){$scope.rolls=[],$scope.frameScores=[],$scope.rollCount=0,$scope.stats={},$scope.rollDisplay="",$scope.gameOver=!1},$scope.submitResults=function(){$http.post("api/bowlers/"+$scope.id,{game:{pinCount:$scope.stats.pinCount,rollCount:$scope.stats.rollCount,gutterBalls:$scope.stats.gutterBalls,strikes:$scope.stats.strikes,spares:$scope.stats.spares,sparePercentage:$scope.stats.sparePercentage,strikePercentage:$scope.stats.strikePercentage,score:$scope.stats.score}}).success(function(){socket.emit("stats:update")}).error(function(err){console.log(err)})},analyze=function(){var i,strikes=0,spares=0,gutters=0,rolls=$scope.rollDisplay.split(""),pinCount=0;for(i=0;i<$scope.rolls.length;i++)pinCount+=$scope.rolls[i];for(i=0;i<rolls.length;i++)"X"===rolls[i]&&strikes++,"/"===rolls[i]&&spares++,"-"===rolls[i]&&gutters++;return $scope.stats={pinCount:pinCount,rollCount:$scope.rollCount,gutterBalls:gutters,spares:spares,strikes:strikes,sparePercentage:spares/($scope.rollCount-strikes)*100,strikePercentage:strikes/$scope.rollCount*100,currentScore:$scope.frameScores[$scope.frameScores.length-1]},$scope.stats},isGameOver=function(){return 10===$scope.frameScores.length},isSecondRoll=function(){return $scope.rollDisplay.length%2===1},isTooLargeForSpare=function(pins){return pins+$scope.rolls[$scope.rolls.length-1]>10},isTenthFrame=function(){return $scope.rollDisplay.length>=17},isTenthFrameThirdRollSpareTry=function(){var check="X"!==$scope.rollDisplay[19]&&20===$scope.rollDisplay.length;return check};var disabled=$scope.disabled=function(pins){var check=isGameOver()||isSecondRoll()&&isTooLargeForSpare(pins)&&!isTenthFrame()||isTenthFrameThirdRollSpareTry()&&isTooLargeForSpare(pins);return check};return disabled}}}])}.call(this),function(angular){"use strict";angular.module("app.directives",["app.directive.scoreCard","app.directive.replies","app.directive.bars"])}(angular),function(){"use strict";var FrameScorer;angular.module("app.filter.frameScore",[]).filter("frameScores",function(){return function(rolls){return new FrameScorer(rolls).frameScore()}}),FrameScorer=function(){function FrameScorer(rolls){this.rolls=rolls}return FrameScorer.prototype.frameScore=function(scores,here){return scores||(scores=[]),here||(here=0),this.isIncompleteFrame(here)?scores:this.isSpare(here)?this.pushThisScoreAndFinish(scores,this.sumNextThreePins(here),here+2):this.isStrike(here)?this.pushThisScoreAndFinish(scores,this.sumNextThreePins(here),here+1):this.pushThisScoreAndFinish(scores,this.sumNextTwoPins(here),here+2)},FrameScorer.prototype.pushThisScoreAndFinish=function(scores,thisFrameScore,nextFrameStart){return scores.push(this.lastScore(scores)+thisFrameScore),this.frameScore(scores,nextFrameStart)},FrameScorer.prototype.isStrike=function(here){return 10===this.rolls[here]},FrameScorer.prototype.isSpare=function(here){return this.rolls[here]+this.rolls[here+1]===10&&!this.isStrike(here)},FrameScorer.prototype.sumNextThreePins=function(here){return this.rolls[here]+this.rolls[here+1]+this.rolls[here+2]},FrameScorer.prototype.sumNextTwoPins=function(here){return this.rolls[here]+this.rolls[here+1]},FrameScorer.prototype.lastScore=function(scores){var ref=scores[scores.length-1];return ref?ref:0},FrameScorer.prototype.isIncompleteFrame=function(here){return this.isShortFrameOrNakedStrike(here)||this.isNakedSpareOrStrikeWith1Roll(here)},FrameScorer.prototype.isNakedSpareOrStrikeWith1Roll=function(here){return this.rolls.length===here+2&&(this.isStrike(here)||this.isSpare(here))},FrameScorer.prototype.isShortFrameOrNakedStrike=function(here){return this.rolls.length<=here+1},FrameScorer}()}.call(this),function(){"use strict";var RollDisplayer;angular.module("app.filter.rollDisplay",[]).filter("rollDisplay",function(){return function(rolls){return new RollDisplayer(rolls).rollDisplay()}}),RollDisplayer=function(){function RollDisplayer(rolls){this.rolls=rolls}return RollDisplayer.prototype.rollDisplay=function(str,here){return str||(str=""),here||(here=0),this.rolls.length===here?str:this.rolls.length!==here+1||this.isStrike(here)?this.isStrike(here)?this.rollDisplay(str+this.spaceUnlessTenth(str)+"X",here+1):this.isSpare(here)?this.rollDisplay(str+this.displayPins(here)+"/",here+2):this.rollDisplay(str+this.displayPins(here)+this.displayPins(here+1),here+2):str+this.displayPins(here)},RollDisplayer.prototype.displayPins=function(here){var str="-123456789",ref=str[this.rolls[here]];return null!==ref?ref:"?"},RollDisplayer.prototype.isStrike=function(here){return 10===this.rolls[here]},RollDisplayer.prototype.isSpare=function(here){return this.rolls[here]+this.rolls[here+1]===10&&!this.isStrike(here)},RollDisplayer.prototype.spaceUnlessTenth=function(str){return str.length>=18?"":" "},RollDisplayer}()}.call(this),function(angular){"use strict";angular.module("app.filters",["app.filter.rollDisplay","app.filter.frameScore"])}(angular),function(){"use strict";angular.module("app.service.auth",[]).factory("Auth",["$http","$location","$q","$timeout",function($http,$location,$q,$timeout){var auth={};return auth.user={username:!1,access:!1,id:!1},auth.message=!1,auth.login=function(username,password,cb){$http.post("/login",{username:username,password:password}).success(function(user){auth.user.username=user.username,auth.user.access=user.access,auth.user.id=user._id,auth.message="Authentication successful.",cb()}).error(function(err){auth.message=err})},auth.logout=function(cb){$http.post("/logout").success(function(){auth.user.username=!1,auth.user.access=!1,auth.user.id=!1,auth.message="You are logged out.",cb()}).error(function(err){auth.message=err})},auth.createUser=function(user,cb){console.log("Creating User",user.university.name),$http.post("/register",{username:user.username,firstName:user.firstName,lastName:user.lastName,address:user.address,address2:user.address2,city:user.city,state:user.state,zipcode:user.zipcode,phone:user.phone,university:user.university.name,email:user.email,access:user.access,password:user.password}).success(function(){cb()}).error(function(err){auth.message=err})},auth.createAdmin=function(user,cb){$http.post("/registeradmin",{username:user.username,firstName:user.firstName,lastName:user.lastName,address:user.address,address2:user.address2,city:user.city,state:user.state,zipcode:user.zipcode,phone:user.phone,university:user.university,email:user.email,access:user.access,password:user.password}).success(function(){cb()}).error(function(err){auth.message=err})},auth.isLoggedIn=function(){var defered=$q.defer();return $http.get("/loggedin").success(function(user){"0"!==user?$timeout(function(){defered.resolve()},0):($timeout(function(){defered.reject()},0),$location.url("/login"))}),defered.promise},auth.updatePassword=function(id,password,cb){console.log("updatePassword(): "+id+" "+password),$http.post("/api/users/"+id+"/password",{password:password}).success(function(){cb()}).error(function(err){auth.message=err})},auth}])}.call(this),function(angular){"use strict";angular.module("app.service.localStorage",[]).factory("localStorage",["$window","$q",function($window,$q){var storage={};return storage.prefix="ls.",storage.isAvailable="localStorage"in $window&&null!==$window.localStorage?!0:!1,storage.setPrefix=function(prefix){return"."!==prefix.substr(-1)?void(storage.prefix=prefix?prefix+".":""):void(storage.prefix=prefix)},storage.set=function(key,item){var d=$q.defer();return storage.isAvailable?($window.localStorage.setItem(storage.prefix+key,item),d.resolve("Item was stored.")):d.reject("Your browser sucks, get a new one buddy."),d.promise},storage.get=function(key){var d=$q.defer();return storage.isAvailable?d.resolve($window.localStorage.getItem(storage.prefix+key)):d.reject("Your browser sucks, get a new one buddy."),d.promise},storage.remove=function(key){var d=$q.defer();return storage.isAvailable?($window.localStorage.removeItem(storage.prefix+key),d.resolve("Item was removed.")):d.reject("Your browser sucks, get a new one buddy."),d.promise},storage.clear=function(){var d=$q.defer();return storage.isAvailable?($window.localStorage.clear(),d.resolve("localStorage Cleared.")):d.reject("Your browser sucks, get a new one buddy."),d.promise},storage}])}(angular),function(angular){"use strict";angular.module("app.service.online",[]).factory("Online",["$window",function($window){var online={};return online.requests=[],online.check=function(){return $window.navigator.onLine?!0:!1},online.on=function(event,handler){return $window.addEventListener(event,handler)},online}])}(angular),function(angular){"use strict";angular.module("app.service.socket",[]).factory("socket",function($rootScope){var socket=io.connect();return{on:function(eventName,callback){socket.on(eventName,function(){var args=arguments;$rootScope.$apply(function(){callback.apply(socket,args)})})},emit:function(eventName,data,callback){socket.emit(eventName,data,function(){var args=arguments;$rootScope.$apply(function(){callback&&callback.apply(socket,args)})})}}})}(angular),function(){"use strict";angular.module("app.service.universities",[]).factory("Universities",[function(){var universities={};return universities.list=[{name:"Adelphi"},{name:"Adirondack CC"},{name:"Adrian"},{name:"AIB"},{name:"Akron"},{name:"Alabama"},{name:"Alabama A&M"},{name:"Alabama State"},{name:"Alabama-Birmingham"},{name:"Alcorn State"},{name:"Allegheny-Boyce"},{name:"Allegheny-North"},{name:"Allegheny-South"},{name:"Allen"},{name:"Alma"},{name:"Anne Arundel CC"},{name:"Aquinas"},{name:"Arizona"},{name:"Arizona State"},{name:"Ark. - Pine Bluff"},{name:"Arkansas"},{name:"Arkansas State"},{name:"Ashford"},{name:"Baker"},{name:"Ball State"},{name:"Bellarmine"},{name:"Bethel-TN"},{name:"Bethune-Cookman"},{name:"Black Hills St."},{name:"Bloomsburg"},{name:"Boise State"},{name:"Bowie State"},{name:"Bowling Green State"},{name:"Briarcliffe"},{name:"Bryant"},{name:"Buffalo State"},{name:"Cal. - Davis"},{name:"Cal. - Los Angeles"},{name:"Cal. Poly"},{name:"Cal.- Santa Barbara"},{name:"Cal.St.- Chico"},{name:"Cal.St.- Fresno"},{name:"Cal.St.- Fullerton"},{name:"Cal.St.- Long Beach"},{name:"Cal.St.- Northridge"},{name:"Cal.St.- Sacramento"},{name:"Calumet"},{name:"Campbellsville"},{name:"Canisius"},{name:"Cardinal Stritch"},{name:"Carthage"},{name:"Cayuga CC"},{name:"Central Florida"},{name:"Central Michigan"},{name:"Central Missouri"},{name:"Central Oklahoma"},{name:"Central Washington"},{name:"Chaffey"},{name:"Cheyney"},{name:"Chowan"},{name:"Cincinnati"},{name:"Clackamas CC"},{name:"Clarion"},{name:"Clarke"},{name:"Clarkson"},{name:"Clemson"},{name:"Colorado Mines"},{name:"Colorado St.- Pueblo"},{name:"Colorado State"},{name:"Columbia-Greene CC"},{name:"Concordia"},{name:"Coppin State"},{name:"Cornell"},{name:"Corning CC"},{name:"Cumberland"},{name:"Cumberlands"},{name:"Davenport"},{name:"Delaware"},{name:"Delaware State"},{name:"Delta"},{name:"Dutchess CC"},{name:"East Carolina"},{name:"Eastern Illinois"},{name:"Eastern Michigan"},{name:"Elizabeth City St."},{name:"Elmhurst"},{name:"Emmanuel"},{name:"Emporia State"},{name:"Erie CC"},{name:"Fairleigh Dickinson"},{name:"Fashion Institute"},{name:"Fayetteville State"},{name:"Ferris State"},{name:"Florida"},{name:"Florida A&M"},{name:"Florida Atlantic"},{name:"Florida Inter."},{name:"Florida State"},{name:"Fontbonne"},{name:"George Mason"},{name:"Georgia College"},{name:"Georgia Southern"},{name:"Georgia Tech"},{name:"Globe Institute"},{name:"Graceland"},{name:"Grambling State"},{name:"Grand Canyon"},{name:"Grand Valley State"},{name:"Grand View"},{name:"Hampton"},{name:"Hastings"},{name:"Herkimer CCC"},{name:"Highland CC"},{name:"Holy Family"},{name:"Houston"},{name:"Howard"},{name:"Hudson Valley CC"},{name:"Huntington"},{name:"Idaho"},{name:"Idaho State"},{name:"Illinois - Chicago"},{name:"Illinois - Urbana"},{name:"Illinois State"},{name:"Illinois Tech"},{name:"Indiana"},{name:"Indiana - PA"},{name:"Indiana State"},{name:"Indiana Tech"},{name:"Indiana-S.Bend"},{name:"Iowa"},{name:"Iowa Central CC"},{name:"Iowa State"},{name:"Jackson State"},{name:"James Madison"},{name:"JC Smith"},{name:"Kansas"},{name:"Kansas State"},{name:"Kent State"},{name:"King"},{name:"Kutztown"},{name:"Lafayette"},{name:"Landmark"},{name:"Las Positas"},{name:"Lawrence Tech"},{name:"Lee"},{name:"Lehigh"},{name:"Lewis and Clark"},{name:"Lincoln"},{name:"Linden.-Belleville"},{name:"Lindenwood"},{name:"Lindsey Wilson"},{name:"Linfield"},{name:"Livingstone"},{name:"Long Island"},{name:"Louisiana State"},{name:"Louisiana Tech"},{name:"Louisiana-Lafayette"},{name:"Louisville"},{name:"Marian"},{name:"Marist"},{name:"Marquette"},{name:"Martin Methodist"},{name:"Maryland-Balt.Co."},{name:"Maryland-Coll.Park"},{name:"Maryland-E.Shore"},{name:"Maryland-Univ.Coll."},{name:"McKendree"},{name:"Medaille"},{name:"Mesa CC"},{name:"Miami"},{name:"Miami - OH"},{name:"Michigan"},{name:"Michigan - Flint"},{name:"Michigan State"},{name:"Michigan-Dearborn"},{name:"Mid. Tennessee St."},{name:"Midland"},{name:"Millersville"},{name:"Milwaukee Eng."},{name:"Minn.-Twin Cities"},{name:"Minn.St.-Mankato"},{name:"Mississippi Vall."},{name:"Missouri Baptist"},{name:"Missouri State"},{name:"Mohawk Valley CC"},{name:"Monmouth"},{name:"Monroe CCC"},{name:"Montana"},{name:"Montana State"},{name:"Morehead State"},{name:"Morgan State"},{name:"Morningside"},{name:"Mount Aloysius"},{name:"Mount Mercy"},{name:"Mount Union"},{name:"Muskingum"},{name:"N. Carolina A&T"},{name:"N. Carolina Cent."},{name:"N. Carolina State"},{name:"N. Carolina-Charl."},{name:"Nassau CC"},{name:"Nebraska - Kearney"},{name:"Nebraska - Lincoln"},{name:"Nebraska - Omaha"},{name:"Nevada - Las Vegas"},{name:"Nevada - Reno"},{name:"New Haven"},{name:"New Jersey"},{name:"New Jersey City"},{name:"New Jersey Tech"},{name:"New Mexico"},{name:"New Mexico State"},{name:"Newman"},{name:"Niagara CCC"},{name:"Norfolk State"},{name:"North Dakota State"},{name:"North Harris"},{name:"North Texas"},{name:"Northeastern St."},{name:"Northern Illinois"},{name:"Northern Iowa"},{name:"Northern Kentucky"},{name:"Notre Dame"},{name:"Notre Dame - OH"},{name:"NW Ohio"},{name:"Oberlin"},{name:"Ohio Dominican"},{name:"Ohio State"},{name:"Ohio-Chillicothe"},{name:"Oklahoma"},{name:"Oklahoma State"},{name:"Oregon"},{name:"Oregon State"},{name:"Our Lady"},{name:"Palmer"},{name:"Paul Smith's"},{name:"PennSt.-Altoona"},{name:"PennSt.-Berks/Leh."},{name:"PennSt.-Harrisburg"},{name:"PennSt.-Main"},{name:"Pikeville"},{name:"Pitt.-Bradford"},{name:"Pitt.-Greensburg"},{name:"Pittsburgh"},{name:"Portland CC"},{name:"Prairie View A&M"},{name:"Purdue"},{name:"R.Morris-Illinois"},{name:"R.Morris-Lake Co."},{name:"R.Morris-Peoria"},{name:"R.Morris-Springfield"},{name:"Radford"},{name:"Ripon"},{name:"Robert Morris-PA"},{name:"Rochester Tech"},{name:"Rock Valley"},{name:"Rockland CC"},{name:"Rose-Hulman IT"},{name:"S.Ill.-Carbondale"},{name:"S.Ill.-Edwardsville"},{name:"Sacred Heart"},{name:"Saginaw Valley St."},{name:"Salem Inter."},{name:"Sam Houston State"},{name:"San Diego State"},{name:"San Jose State"},{name:"Santa Fe"},{name:"Savannah State"},{name:"Schenectady CCC"},{name:"Schoolcraft"},{name:"Shaw"},{name:"Shippensburg"},{name:"Siena Heights"},{name:"South Carolina St."},{name:"South Dakota State"},{name:"South Florida"},{name:"Southern"},{name:"Southern Cal."},{name:"Southern Indiana"},{name:"Southern Oregon"},{name:"Southern Utah"},{name:"Southwestern CC"},{name:"Spalding"},{name:"Spokane Falls CC"},{name:"Spring Hill"},{name:"St. Ambrose"},{name:"St. Augustine's"},{name:"St. Catharine"},{name:"St. Clair CC"},{name:"St. Cloud State"},{name:"St. Francis-IL"},{name:"St. Francis-NY"},{name:"St. Francis-PA"},{name:"St. John's"},{name:"St. Paul's"},{name:"St. Peter's"},{name:"St. Thomas"},{name:"Stanford"},{name:"Stephen F. Austin"},{name:"Stevens Institute"},{name:"Stonehill"},{name:"Stony Brook"},{name:"Suffolk - Grant"},{name:"SUNY - Albany"},{name:"SUNY - Binghamton"},{name:"SUNY - IT"},{name:"SW Christian"},{name:"Syracuse"},{name:"Tabor"},{name:"Technical Career"},{name:"Temple"},{name:"Tenn. - Chattanooga"},{name:"Tenn. - Knoxville"},{name:"Texas - Austin"},{name:"Texas - Dallas"},{name:"Texas A&M"},{name:"Texas Southern"},{name:"Texas State"},{name:"Texas Tech"},{name:"Toledo"},{name:"Towson"},{name:"Tulane"},{name:"U.S. Air Force"},{name:"U.S. Coast Guard"},{name:"Ulster CCC"},{name:"Union"},{name:"Urbana"},{name:"Ursuline"},{name:"Utah"},{name:"Utah State"},{name:"Utica"},{name:"Valparaiso"},{name:"Vanderbilt"},{name:"Victory"},{name:"Vincennes"},{name:"Virginia Comm."},{name:"Virginia State"},{name:"Virginia Tech"},{name:"Virginia Union"},{name:"Viterbo"},{name:"Volunteer State CC"},{name:"Waldorf"},{name:"Washington"},{name:"Washington State"},{name:"Wayne CCC"},{name:"Wayne State-NE"},{name:"Webber Int."},{name:"Weber State"},{name:"Webster"},{name:"West Point"},{name:"West Texas A&M"},{name:"West Virginia"},{name:"West. New England"},{name:"West. Washington"},{name:"Westchester CC"},{name:"Western Illinois"},{name:"Western Kentucky"},{name:"Western Michigan"},{name:"Westminster"},{name:"Wichita State"},{name:"William Paterson"},{name:"William Penn"},{name:"Winona State"},{name:"Winston-Salem St."},{name:"Wisc.-Eau Claire"},{name:"Wisc.-Green Bay"},{name:"Wisc.-LaCrosse"},{name:"Wisc.-Madison"},{name:"Wisc.-Milwaukee"},{name:"Wisc.-Oshkosh"},{name:"Wisc.-Parkside"},{name:"Wisc.-Platteville"},{name:"Wisc.-Stout"},{name:"Wisc.-Whitewater"},{name:"Wisconsin Lutheran"},{name:"Wright State"},{name:"Youngstown State"},{name:"Yuba"}],universities.get=function(){return universities.list
},universities}])}.call(this),function(angular){"use strict";angular.module("app.services",["app.service.auth","app.service.socket","app.service.localStorage","app.service.online","app.service.universities"])}(angular);